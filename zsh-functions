# This is a file full of functions

function chpwd ()
{
    cl

    local GITDIR
    GITDIR="$(git rev-parse --show-toplevel 2>/dev/null)"
    if [[ "$GITDIR" == "$(pwd)" ]]; then
        # Fetch changes for current branch
        git fetch
    fi
}

function ack () {
    if [ -e ~/bin/ack ] ; then
        ~/bin/ack "$@"
    elif [ -e /usr/bin/ack ] ; then
        /usr/bin/ack "$@"
    else
        \grep -lR "$@" | \grep -v "/\.svn/"
    fi
}

function vack () {
    setopt local_options SH_WORD_SPLIT

    if [ type ag >/dev/null 2>&1 ] ; then
        files="$(ag -l "$@")"
    else
        files="$(ack -l "$@")"
    fi

    if [ -z "$files" ] ; then
        echo "No matches found."
    else
        vim $files
    fi
}

function taile () {
    tail -f /var/log/httpd/$1*-error_log
}

function mdless () {
    pandoc -s -f markdown -t man "$*" | groff -T utf8 -man | less;
}

function install () {
    case "$DISTRO" in
        ubuntu)
            # fall through
            ;&
        debian)
            sudo apt-get install "$@"
            ;;
        fedora)
            # fall through
            ;&
        centos)
            # fall through
            ;&
        rhel)
            # fall through
            ;&
        fedora)
            # fall through
            ;&
        redhat)
            sudo yum install "$@"
            ;;
        *)
            echo "Distro '$DISTRO' is unrecognized"
            ;;
    esac
}

function purge () {
    case "$DISTRO" in
        ubuntu)
            # fall through
            ;&
        debian)
            sudo apt-get purge "$@"
            ;;
        fedora)
            # fall through
            ;&
        centos)
            # fall through
            ;&
        rhel)
            # fall through
            ;&
        fedora)
            # fall through
            ;&
        redhat)
            sudo yum remove "$@"
            ;;
        *)
            echo "Distro '$DISTRO' is unrecognized"
            ;;
    esac
}

function update () {
    case "$DISTRO" in
        ubuntu)
            # fall through
            ;&
        debian)
            sudo apt-get update && sudo apt-get upgrade
            ;;
        fedora)
            # fall through
            ;&
        centos)
            # fall through
            ;&
        rhel)
            # fall through
            ;&
        fedora)
            # fall through
            ;&
        redhat)
            sudo yum update
            ;;
        *)
            echo "Distro '$DISTRO' is unrecognized"
            ;;
    esac
}

function search () {
    case "$DISTRO" in
        ubuntu)
            # fall through
            ;&
        debian)
            sudo apt-cache search "$@"
            ;;
        fedora)
            # fall through
            ;&
        centos)
            # fall through
            ;&
        rhel)
            # fall through
            ;&
        fedora)
            # fall through
            ;&
        redhat)
            sudo yum search "$@"
            ;;
        *)
            echo "Distro '$DISTRO' is unrecognized"
            ;;
    esac
}
